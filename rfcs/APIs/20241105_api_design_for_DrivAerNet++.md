# DrivAerNet++ 论文复现设计文档

| 任务名称                     | Hackathon 7th PPSCI No.3 |  
|-----------------------------|--------------------------|
| 提交作者                     | LilaKen                 |  
| 提交时间                     | 2024-11-05              |  
| 版本号                       | V1.0                    |  
| 依赖飞桨版本                 | 基于 develop 版本开发   |  
| 文件名                       | 20241105_api_design_for_DrivAerNet++.md |  

# 一、概述
## 1、相关背景
在汽车的空气动力学设计中，通过数值方法计算和风洞实验优化车辆外形设计是一项重要的工作。然而，这些传统方法的时间成本和经济成本都较高。近年来，随着深度学习的快速发展，数据驱动方法在汽车外形设计的气动性能预测中展现出极大潜力。DrivAerNet++ 是一个包含大规模多样化汽车几何数据集的项目，旨在通过数据驱动的方法，精确快速地预测汽车的空气阻力等气动特性。

## 2、功能目标
本次任务旨在复现 DrivAerNet++ 的 RegDGCNN 和 PointNet 网络模型。在包含 8000 个样本的 DrivAer++ 数据集上实现高精度的气动性能预测，确保预测精度与论文中指标对齐，并满足代码审核要求。具体目标包括：
1. 复现 DrivAer++ 数据集上的 RegDGCNN 和 PointNet 模型。
2. 确保飞桨版本代码的精度达到与原论文一致的水平。
3. 编写完整的设计文档，满足代码审核和发布的规范要求。

## 3、意义
DrivAerNet++ 提供了一个更大规模和多样化的几何数据集，覆盖了更多样的汽车设计需求。该数据集和基于图卷积与点云网络的模型在气动性能预测中具有极高的效率和精准度。相比传统的 CFD 方法，深度学习方法能够在秒级时间内实现预测仿真，极大降低了设计成本。

# 二、飞桨现状
飞桨框架当前支持一般的图神经网络和点云模型，但未直接提供类似于 RegDGCNN 和 PointNet 的特定实现。此次复现将基于飞桨框架构建这两种模型，确保其在 DrivAer++ 数据集上的性能符合原论文标准。

# 三、业内方案调研
在基于图卷积和点云特征提取的网络设计中，PointNet 和 RegDGCNN 是较为典型的方法。PointNet 直接处理点云数据，捕获其空间特征，而 RegDGCNN 则通过图卷积网络进一步增强了点与点之间的依赖关系。以下是业内常见方案的对比：

| 方法         | 模型特点                           | 适用领域                  | 优劣势                        |
|--------------|------------------------------------|---------------------------|-------------------------------|
| PointNet     | 直接处理点云数据，结构简单         | 3D 点云分类与分割         | 快速高效，但无法捕获复杂依赖关系 |
| GCN          | 基础图卷积网络                     | 一般图数据处理            | 结构简单，但对连续数据适用性有限 |
| GraphSAGE    | 可扩展图卷积，支持大规模图处理     | 大规模图网络              | 支持节点归纳，适合规模化数据   |
| RegDGCNN     | 结合图卷积和距离关系的特征提取     | 复杂几何数据处理          | 精度高，适合复杂几何结构      |

# 四、设计思路与实现方案

## 1. 主体设计具体描述
首先复现基于 Pytorch 版本的 DrivAerNet++ 代码，并确认其与论文指标一致。随后使用 Paconvert 工具将 Pytorch 代码转换为飞桨代码，并手动调整不兼容的部分，特别是图卷积层和特定激活函数的实现。飞桨版本代码完成后，在 DrivAer++ 数据集上测试其精度。对于公式(复现指标-源论文指标)/源论文指标<10%，确保模型的精度在可接受范围内。

## 2. 主体设计选型考量
在复现模型时，选择了图卷积网络（RegDGCNN）和点云网络（PointNet）以捕获 DrivAer++ 数据集中的复杂几何关系。以下是选型考量：
- **网络模型选择**：RegDGCNN 用于捕捉几何结构的全局和局部依赖关系，PointNet 简化了对点云数据的处理流程。
- **飞桨框架适配**：使用 Paconvert 进行代码转换，并对不兼容部分手动适配。
- **数据加载和批处理**：由于 DrivAer++ 包含 8000 个样本，设计了高效的数据加载策略以支持模型的高效训练。

# 五、测试和验收的考量
在 DrivAer++ 数据集上复现的 RegDGCNN 和 PointNet 模型，设置以下测试标准：
1. **精度验证**：确保飞桨版本模型的精度与原论文一致，且相对误差小于 10%。
2. **代码可运行性**：验证代码在飞桨框架下的稳定性，包括数据加载、模型训练和推理。
3. **性能测试**：对比飞桨和 Pytorch 版本的推理速度，确保飞桨版本在相同硬件条件下的推理速度。

### Pytorch 和原论文的对比结果：
| Model     | MSE(10^-5) | MAE(10^-3) | Max AE(10^-3) | R²     | 备注 |
|-----------|------------|------------|---------------|--------|------|
| RegDGCNN  | 14.2       | 9.31       | 12.79        | 0.641  | 原论文 |
| PointNet  | 14.9       | 9.6        | 12.45        | 0.643  | 原论文 |
| RegDGCNN  | 待测试     | 待测试     | 待测试       | 待测试 | Pytorch复现 |
| PointNet  | 11         | 8.147      | 13.7777      | 0.7158 | BS16  |

# 六、影响面
此次实现为新增 API，主要涉及 DrivAer++ 数据集和气动预测模块，对其他模块没有影响，未来可扩展至其他飞桨图神经网络模块。

# 七、排期规划
- **2024/11/10 - 2024/11/20**：完成 DrivAerNet++ 基准模型的 Pytorch 复现，精度与原论文对齐。
- **2024/11/21 - 2024/12/01**：完成飞桨版本的 RegDGCNN 和 PointNet 复现，确保精度与 Pytorch 版本和论文基准一致。
- **2024/12/02 - 2024/12/10**：进行最终的性能优化与测试验收，确保模型精度符合要求并完成文档提交。

# 八、名词解释
- **DrivAerNet++**：一个包含多样化几何数据的汽车空气动力学数据集。
- **RegDGCNN**：一种基于图卷积的网络模型，用于提取复杂几何结构的特征。
- **PointNet**：一种点云数据处理网络，直接对 3D 点云数据进行分类和分割。

# 九、附件及参考资料
- DrivAerNet++ 论文链接：[DrivAerNet++ 论文](https://github.com/Mohamedelrefaie/DrivAerNet#:~:text=preprint%3A%20DrivAerNet%2B%2B%20paper-,here,-DrivAerNet%20Paper%3A)
- DrivAerNet++ 项目代码参考：[GitHub 项目链接](https://github.com/Mohamedelrefaie/DrivAerNet)
