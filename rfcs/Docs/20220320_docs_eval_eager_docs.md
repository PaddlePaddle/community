# 飞桨动态图训练功能体验方案

|领域 | 飞桨动态图训练功能体验 | 
|---|---|
|提交作者<input type="checkbox" class="rowselector hidden"> | OneBeaker | 
|提交时间<input type="checkbox" class="rowselector hidden"> | 2022-03-20 | 
|版本号 | V1.0 | 
|依赖飞桨版本<input type="checkbox" class="rowselector hidden"> | paddlepaddle-gpu==2.2 | 
|文件名 | 20220320_docs_eval_eager_docs.md<br> | 


# 一、概述
## 1、相关背景

飞桨框架于 2.0 正式版全面支持了动态图训练，针对这些功能，Paddle也新增了对应的使用文档。

静态图以性能见长，动态图以易用性见长。各个框架都在往完备角度先后支持两种模式。

而两种模式的平滑过渡、文档完善程度等都是用户关心和在意的问题。

## 2、功能目标

深度体验飞桨动态图训练功能，并产出一份文档功能体验报告。

## 3、意义

从用户角度体验飞桨动态图模式的特点，发掘文档体系中可以改善的功能点。

# 二、飞桨现状

飞桨从 [2.0.0](https://github.com/PaddlePaddle/Paddle/releases/tag/v2.0.0) 默认开启动态图模式进行模型开发和训练。

在此之前，飞桨默认启动的是静态图模式。

随着 2.0 的发布以及 2.1、2.2 的完善，飞桨在动态图的完备和易用的体验上不断升级。但是某些文档的部分可能还未做同步，或者在同步过程中发生了遗漏。

比如 https://www.paddlepaddle.org.cn/documentation/docs/zh/guides/04_dygraph_to_static/index_cn.html 页面中的所引用的链接 “动态图和静态图的差异” 是失效的。

此外，飞桨的文档显式遵循了 https://documentation.divio.com/ 所描述的文档体系。这与 [MindSpore](https://www.mindspore.cn/) 类似。与 [PyTorch](https://pytorch.org/docs/stable/index.html) 不同。这在用户体验上各有特色，给用户不同的感受。



# 三、业内方案调研

国内外主流框架对于静态图、动态图的默认模式罗列如下：

- TensorFlow 2.0 后默认开启动态图模式。
- PyTorch 默认开启动态图模式。
- 飞桨 2.0 后默认开启动态图模式。
- OneFlow 0.5 之后默认开启动态图模式。
- MindSpore 默认开启静态图模式。

各个框架围绕动态图模式，都提供了对应的 tutorial、API 文档。

# 四、对比分析

从便于用户上手的角度考虑，动态图模式无疑对用户更为友好。因此大部分主流框架选择动态图作为默认模式，并为此准备上手文档。

PyTorch 作为第一个将动态图模式发扬光大的深度学习框架，在动态图模式下积累了大量的官方、第三方的学习资料。

TensorFlow 以静态图起家，在工业部署方面积累了丰富的基础组件和用户群体，较早解决了从训练到部署落地的工业问题。不过在 API 设计方面，TensorFlow 由于各种原因导致的 API 功能重复、概念复杂，降低了用户体验感受，同时也间接影响到了文档结构的清晰。

其它的主流深度学习框架，都或多或少受到 TensorFlow 与 PyTorch 的影响。

总结而言，影响动态图用户体验的文档、API 接口可以归为以下几个方面：

- 从其它平台迁移到当前框架的难度，越低越好。影响因素包括算子的完备性、API 接口的概念一致性、配套工具的完备性（如 ONNX 格式转换工具）、相关指导教程的完备度
- 动态图与静态图的转换难度，越低越好。影响因素包括：动态图与静态图概念辨析、动态图与静态图的编程风格的差别、静态图模式下的算子完备度、动态图与部署的距离以及相关指导的教程完备度


# 五、设计思路与实现方案

本体验报告预计基于以下几方面的体验形成文字：

1. 假定用户有上手需求：用户是 PyTorch 熟手，但是还未接触过飞桨，他如何从飞桨文档官网上获取信息上手飞桨。
2. 假定用户有模型迁移的需求：当用户手头有 PyTorch（或其它主流框架）的模型，他如何依据飞桨文档官网上的信息，成功将模型迁移至飞桨，并验证正确性。
3. 假定用户是开源爱好者：当用户想自发地位飞桨的文档做贡献时，他如何依据飞桨公开的信息，获取到他能参加哪些活动，如何参与到飞桨的开源建设中来。
4. 中英文用户：假定用户既有阅读英文资料又有阅读英文资料的需求，他在飞桨文档官网上的体验如何。

报告形成的维度包括：

- 形式：主要报告有否错别字、链接错误、文档内容是否及时更新
- 内容组织：依据 https://documentation.divio.com/ 中的文档四象限理论，与其它主流框架做对比，讨论飞桨的文档组织的特点
- 结合其它用户体验良好的 AI 领域的有关库（如 HuggingFace）做对比分析


## 命名与参数设计

因为是报告形式，无 API 接口设计


# 六、测试和验收的考量

提交深度体验报告及相关代码（如果有）。具体考量标准和方式以飞桨 RFC 中讨论为准。

# 七、可行性分析和排期规划

对各主流深度学习框架已经有一定了解，需要进一步做细致的体验测试及分析。形成详细的报告文档。

预计整体的工作量在三周内可完成，不会晚于黑客松设定的验收 DDL。


# 八、影响面

无

# 名词解释

# 附件及参考资料
